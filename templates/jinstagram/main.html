<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">


      <!-- 숫자_롤링 -->
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'number-swiper.css' %}">

    <!-- 부트스크립트 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

    <!-- 구글아이콘 사용-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!-- Jquery -->
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>







  </head>
<body>

<nav class="navbar navbar-expand-lg bg-body-tertiary" style="position:fixed; width: 100%;">
    <div class="container-fluid" style="justify-content: space-between; flex-wrap: nowrap;">
        <a class="navbar-brand" href="#"><img STYLE="width: 150PX" src="https://i.pinimg.com/564x/7f/61/0e/7f610ecbf364e95f2c97a12fdde9682b.jpg"></a>
        <!-- 검색하는 공간 -->
        <input class="form-control me-2" style="width: 400px;" type="search" placeholder="Search" aria-label="Search">

        <div>
            <span class="material-symbols-outlined">home </span>
            <span class="material-symbols-outlined">send</span>
            <span id="nav_bar_add_box" class="material-symbols-outlined">add_box</span>
            <span class="material-symbols-outlined">favorite</span>
            <span class="material-symbols-outlined">monitor_weight</span>
        </div>
    </div>
</nav>


<div style="display: flex; flex-direction: row; text-align: center; justify-content: center;padding-top: 80px; background-color: ghostwhite;">
    <div style="width: 600px; height :1000px; margin-right: 256px;">

        <!-- 피드박스 -->
        {% for feed in feeds %}
            <div class="feed_box">
                <div style="border: solid 1px rgb(128,128,128); background-color: white;">
                    <!--피드_상단_프로필-->
                    <div style="display: flex;flex-direction: row; align-items: center;">
                        <div class="box" style="width: 80px;height: 80px; margin:10px;">
                            <!--프로필 이미지-->
                            <img class="profile"
                                 src={{ feed.profile_image }}>
                        </div>
                        <div style="font-size: 20px;">
                            {{ feed.user_id }}
                        </div>
                    </div>

                    <!--게시글 이미지-->
                    <div>
                        <img style="width: 90%;height:90%;object-fit: cover;"
                             src="{% get_media_prefix %}{{ feed.image }}">
                    </div>

                    <!-- 아이콘 공간-->
                    <div style="display: flex; flex-direction: row;justify-content: space-between; margin-left: 30px;margin-right: 30px; margin-top: 10px;">
                        <div>
                            <span class="material-symbols-outlined" style="font-size: 30px;">favorite</span>
                            <span class="material-symbols-outlined" style="font-size: 30px; margin: 5px;">comment</span>
                            <span class="material-symbols-outlined" style="font-size: 30px;">send</span>
                        </div>

                        <div>
                            <span class="material-symbols-outlined"
                                  style="font-size: 32px; margin-top: 5px;">bookmark</span>
                        </div>
                    </div>

                    <!-- 하단 댓글 공간-->
                    <div>
                        <div style="text-align: left;font-size: 12px; margin-left: 30px;margin-bottom: 8px;">우유님 외 <b>{{ feed.like_count }}명</b>이 좋아합니다. </div>
                        <div style="text-align: left;font-size: 16px; margin-left: 30px;margin-bottom: 8px;"><b>{{ feed.user_id }}</b>  {{ feed.content }}</div>
                        <div style="text-align: left;font-size: 16px; margin-left: 35px;margin-bottom: 8px; color: rgb(128,128,128);">댓글 10개 모두 보기</div>
                        <div style="text-align: left;font-size: 13px; margin-left: 35px;"><b>라봉이</b> 나도 줘!!!</div>
                        <div style="text-align: left;font-size: 13px; margin-left: 35px;"><b>라떼</b> 거기에 커피까지 마신다면...!! 크흐~~!</div>


                        <div style="display: flex;flex-direction: row;margin-top: 5px;">
                            <span style="margin-top: 5px; margin-left: 35px;margin-bottom: 5px;margin-right: 10px;" class="material-symbols-outlined">sentiment_satisfied</span>
                            <input type="text" class="form-control"style="box-shadow: none;"placeholder="    댓글 달기..">
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
    <div style="width: 400px; height :1000px;position: fixed; left: 62%;">

        <div style="display: flex;flex-direction: row; align-items: center;">
            <div class="box" style="width: 50px;height: 50px; margin:30px; margin-right:10px; ">
                <!--프로필 이미지-->
                <img class="profile" src="https://i.pinimg.com/564x/f0/60/5b/f0605bd5c15d7a655bbc6b73bb9f6e64.jpg">
            </div>

            <div style="margin-top: -10px;text-align: left;">
                <div>kugring</div>
                <div style="font-size: 12px; color: rgb(107, 99, 99);"> @lim_jae_hyuk</div>
            </div>
        </div>

        <div> 즐거운 추석 보내세요!</div>
        <div> 추천인 프로필</div>
        <div> 추천인 프로필</div>



    </div>
</div>






<!-- 첫번째 모달-->
<div id="first_modal" class="modal_overlay">
    <div class="modal_window" >
        <div style="display: flex; flex-direction:row; justify-content: space-between;">
            <div style="width: 40px; height: 30px; background: rgb(128,128,128)">

            </div>
            <div>
                새 이미지 업로드
            </div>
            <div style="width: 40px; height: 30px; background: rgb(128,128,128)">
                <span class="material-symbols-outlined">close</span>
            </div>
        </div>
        <div class="img_upload_space" style="border-top: solid 1px darkgray;width: 778px; height: 540px; margin-top:10px;"></div>
    </div>
</div>
<!-- 두번째 모달 -->
<div id="second_modal" class="modal_overlay">
    <div class="modal_window" >
        <div style="display: flex; flex-direction:row; justify-content: space-between;">
            <div style="width: 40px; height: 30px; background: rgb(128,128,128)">

            </div>
            <div>
                새 이미지 업로드
            </div>
            <div style="width: 40px; height: 30px; background: rgb(128,128,128)">
                <span class="material-symbols-outlined">close</span>
            </div>
        </div>
        <div style = "display:flex; flex-direction: row;border-top: solid 1px darkgray;margin-top:10px;">
            <div class="img_upload_space" style="width: 500px; height: 540px;">

            </div>
            <div style = "border-left: solid 1px darkgray">
                <div>
                    <textarea id="input_feed_content" class="form-control" style="width: 276px; height: 400px" id="exampleFormControlTextarea1" rows="5"></textarea>
                </div>
                <button id="feed_create_button" type="button" class="btn btn-warning" style="width: 100%;">
                    공유하기
                </button>
                <div>
                    <select class="form-select" aria-label="Default select example">
                        <option selected>Open this select menu</option>
                        <option value="1">One</option>
                        <option value="2">Two</option>
                        <option value="3">Three</option>
                    </select>
                </div>

                <div>

                </div>
            </div>
        </div>
    </div>
</div>






<script src="{% static 'number-swiper.js' %}"></script>

<script>
  var numbers = new NumberSwiper('myNumberSwiper');
  var selectedValue = numbers.value;
</script>

<script>

    let files;

    $('#nav_bar_add_box').click(function (){
        $('#first_modal').css({
            display : 'flex'
        });

        $(document.body).css({
            overflow: 'hidden'
        })
    });

    $('#feed_create_button').click(function() {
        alert("공유하기 눌렀다!" + $('#input_feed_content').val());

        let file = files[0];
        let image = files[0].name ;
        let content =$('#input_feed_content').val();
        let user_id ="kugring";
        let profile_image ="https://i.pinimg.com/564x/f0/60/5b/f0605bd5c15d7a655bbc6b73bb9f6e64.jpg";

        let fd =new FormData();

        fd.append('file',file);
        fd.append('image',image);
        fd.append('content',content);
        fd.append('user_id',user_id);
        fd.append('profile_image',profile_image);

        $.ajax({
            url: "/upload",
            data: fd,
              method: "POST",
                processData: false,
                contentType: false,
                success: function (data){
                    console.log("성공");
                },
                error: function (request, status, error) {
                console.log("에러");
                },
                complete: function(){
                console.log("완료");
                location.replace("/main/");
                }
        })
    });

    $('.img_upload_space')

        .on("dragover", dragOver)
        .on("dragleave", dragOver)
        .on("drop",uploadFiles);

    function dragOver(e) {
        e.stopPropagation();
        e.preventDefault();

        console.log(e)
        if (e.type == "dragover") {
            $(e.target).css({
                "background-color" : "black",
                "outline-offset" : "-20px"
            });
        } else {
            $(e.target).css({
                "background-color" : "orange",
                "outline-offset" : "-10px"
            });
        }
    }

    function uploadFiles(e) {
        e.stopPropagation();
        e.preventDefault();

        e.dataTransfer = e.originalEvent.dataTransfer; //2
            files = e.target.files || e.dataTransfer.files;
        if (files.length > 1){
            alert("하나만 올려라.");
            return;
        }

        if (files[0].type.match(/image.*/)) {

            $('#first_modal').css({
                display : 'none'
            });
            $('#second_modal').css({
                display : 'flex'
            });


            $('.img_upload_space').css({
                "background-image": "url(" + window.URL.createObjectURL(files[0]) + ")",
                "outline": "none",
                "background-size": "100%",
                "background-repeat" : "no-repeat",
                "background-position" : "center"
            });
        } else {
            alert("이미지가 아닙니다.");
            return;
        }
    }
</script>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
</body>
</html>
     

<!-- <div style="display: flex;flex-directio`n: row;" >
    <div class="img-container">
        <img src="https://i.pinimg.com/236x/2d/df/96/2ddf96091cd480d5466ad056fead575e.jpg" alt="Image 1">
      </div>
    

      <div class="img-container">
        <img src="https://i.pinimg.com/564x/aa/c2/e9/aac2e9497979513aeb4b8e25e8d79b7c.jpg" alt="Image 2">
    </div>
</div> -->


    

</div>



